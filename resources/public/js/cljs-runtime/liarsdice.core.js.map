{"version":3,"sources":["liarsdice/core.cljs"],"mappings":";AAOA,AAAKA,2BAAU,gDAAA,2CAAA,2DAAA,tJAACC;AAEhB,8BAAA,9BAAMC;AAAN,AACE,2BAAA,pBAACC,yCASC,WAAKC;AAAL,AACE,IAAMC,SAAO,AAAUD;IACjBE,gBAAc,AAAkBD;IAChCE,OAAK,2IAAA,2EAAA,tNAACC,0DAAQ,AAACC,gBAAWH;AAFhC,AAGE,OAACI,sBAAOV,yBAAUO;;;AAE1B,+BAAA,/BAAMI;AAAN,AAAA,0FAAA,mDAAA,mFAAA,kDAAA,4CAAA,mFAAA,8CAAA,uDAAA,mFAAA,0LAAA,mFAAA,8CAAA,7QAIO,AAAA,yFAAA,AAAAC,gBAAWZ,kLACG,AAAA,4FAAA,AAAAY,gBAAaZ;;AAElC,yBAAA,zBAAMa;AAAN,AACE,iDAAA,jDAACC,oIAAaH,qCAAe,wBAAA,xBAAiBI;;AAC9C,+CAAA,xCAACC,YAAed","names":["liarsdice.core/app-state","reagent.core.atom","liarsdice.core/poll-backend","goog.net.XhrIo/send","e","xhr-io","response-text","data","cljs.core.js__GT_clj","goog.json/parse","cljs.core/reset!","liarsdice.core/app-component","cljs.core/deref","liarsdice.core/init-fn","reagent.dom.render","js/document","js/setInterval"],"sourcesContent":["(ns liarsdice.core\n  (:require [reagent.core :as r]\n            [reagent.dom :as rdom]\n            [cljs.reader :as reader]\n            [goog.net.XhrIo :as xhr]\n            [goog.json :as json]))\n\n(def app-state (r/atom {:message \"Waiting for backend...\"}))\n\n(defn poll-backend []\n  (xhr/send\n    ;; if we are routing to ozlabs.dev\n    ;;        (which I am)\n    ;; then we need to include /liarsdice\n    ;; in the req url -- see the comment\n    ;; in (defn page-handler ... ) in\n    ;; src/clj/dev_server.clj where this\n    ;; issue also pops up\n    \"liarsdice/api/poll\"\n    (fn [e]\n      (let [xhr-io (.-target e)\n            response-text (.getResponseText xhr-io)\n            data (js->clj (json/parse response-text) :keywordize-keys true)]\n        (reset! app-state data)))))\n\n(defn app-component []\n  [:div\n   [:h1 \"Minimal Clojure/ClojureScript App\"]\n   [:p \"This is the frontend talking to the backend.\"]\n   [:p (:message @app-state)]\n   [:p \"Timestamp: \" (:timestamp @app-state)]])\n\n(defn init-fn []\n  (rdom/render [app-component] (.getElementById js/document \"app\"))\n  (js/setInterval poll-backend 500))\n"]}